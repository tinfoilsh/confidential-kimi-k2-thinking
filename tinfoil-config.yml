shim-version: v0.4.1@sha256:3187744b40047060b9567d4b964a394ea0f21b29f99dd371b3e1c91ecee3c196
cvm-version: 0.6.8
cpus: 32
memory: 262144

models:
  - name: "kimi-k2-thinking"
    repo: "moonshotai/Kimi-K2-Thinking@612681931a8c906ddb349f8ad0f582cb552189cd"
    mpk: "83a9b1859995ac80eba3e4d928ea04d1aaa6f855ed80f32eb75098526c272f2d_594256601088_69ba6dc2-989f-56d7-8ea2-db7d537f3725"
  
containers:
  - name: "kimi-k2-thinking"
    image: "vllm/vllm-openai:v0.16.0-cu130@sha256:9e6e8a306b46b249d637d6da056753fd258f89ad84bf0e12afc579124571288e"
    runtime: nvidia
    gpus: all
    ipc: host
    env:
      - LD_LIBRARY_PATH: "/usr/local/nvidia/lib64:/usr/local/nvidia/lib:/usr/lib/x86_64-linux-gnu"
    command: [
      "--model", "/tinfoil/mpk/mpk-83a9b1859995ac80eba3e4d928ea04d1aaa6f855ed80f32eb75098526c272f2d",
      "--tensor-parallel-size", "8",
      "--decode-context-parallel-size", "8",
      "--served-model-name", "kimi-k2-thinking",
      "--enable-auto-tool-choice",
      "--tool-call-parser", "kimi_k2",
      "--reasoning-parser", "kimi_k2",
      "--trust-remote-code",
      "--port", "8001"
    ]

shim:
  listen-port: 443
  upstream-port: 8001
  authenticated: true
  paths:
    - /v1/chat/completions
    - /metrics
    - /health
